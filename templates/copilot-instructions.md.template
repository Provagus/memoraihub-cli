# Copilot Instructions

> Instructions for AI agents working in this workspace.

## üß† Knowledge Base (meh)

This project uses **meh** as a knowledge base for AI. You have access to MCP tools.

### ‚ö†Ô∏è Tool Names

MCP tools have `mcp_meh_` prefix:
- ‚ùå `meh_facts` (conceptual name)
- ‚úÖ `mcp_meh_meh_facts` (actual tool name)

### Session Workflow

#### 1. START - at the beginning of session
```
mcp_meh_meh_notify({"action": "get"})           # check what changed
mcp_meh_meh_facts({"action": "browse", "path": "@", "mode": "tree"})  # see structure
mcp_meh_meh_facts({"action": "get", "id_or_path": "@readme"})  # read onboarding
```

#### 2. WORK - during task
```
mcp_meh_meh_facts({"action": "search", "query": "topic"})  # BEFORE answering
mcp_meh_meh_write({"action": "add", "path": "@path", "content": "..."})  # document discoveries
mcp_meh_meh_write({"action": "bulk_vote", "votes": [{"fact_id":"meh-01XXX","vote":"+1","reason":"Agree"}]})  # vote on proposals
```

#### 3. END - after finishing
```
mcp_meh_meh_write({"action": "add", "path": "@meh/bugs/...", "content": "..."})  # DOCUMENT BUGS FIXED
mcp_meh_meh_write({"action": "add", "path": "@meh/changelog/...", "content": "..."})  # DOCUMENT CHANGES
mcp_meh_meh_notify({"action": "ack", "notification_ids": ["*"]})  # acknowledge notifications
```

**‚ö†Ô∏è CRITICAL: Always document your work!**
- Fixed a bug? ‚Üí `mcp_meh_meh_write()` to `@meh/bugs/...`
- Made changes? ‚Üí `mcp_meh_meh_write()` to `@meh/changelog/...`
- Found something important? ‚Üí `mcp_meh_meh_write()` to appropriate path
- **DO NOT SKIP THIS STEP** - future sessions need this context!

### Available Tools (4 merged tools)

| Tool | Actions | When to use |
|------|---------|-------------|
| `mcp_meh_meh_facts` | search, get, browse, federated_search | Read facts from knowledge base |
| `mcp_meh_meh_write` | add, correct, extend, deprecate, bulk_vote | Write/modify facts |
| `mcp_meh_meh_notify` | get, ack, subscribe | Manage notifications |
| `mcp_meh_meh_context` | list_kbs, switch_kb, switch_context, show | Manage KB context and session |

### Path Conventions

```
@docs/           - documentation
@bugs/           - found bugs
@todo/           - tasks to do
@decisions/      - architectural decisions
@board/          - dashboards and status
```

### What to Document?

‚úÖ **ALWAYS DOCUMENT (use mcp_meh_meh_write):**
- **Any bug you found and fixed** ‚Üí `@meh/bugs/bug-name`
- **Any code changes or refactoring** ‚Üí `@meh/changelog/change-name`
- **Architectural decisions made** ‚Üí `@meh/architecture/decision-name`
- **Security improvements** ‚Üí `@meh/server/security-*` (extend if exists)
- **New features implemented** ‚Üí `@meh/changelog/feature-name`
- **Important discoveries** ‚Üí `@meh/notes/discovery-name`
- **TODOs for future** ‚Üí `@meh/todo/task-name`

‚ùå **DO NOT DOCUMENT:**
- Code itself (it's in git)
- Obvious things from code
- Temporary notes (use comments in code instead)

### üö® MANDATORY DOCUMENTATION CHECKLIST

After EVERY task that modifies code, YOU MUST:

1. ‚úÖ Document bugs fixed: `mcp_meh_meh_write({"action": "add", "path": "@meh/bugs/...", ...})`
2. ‚úÖ Document changes made: `mcp_meh_meh_write({"action": "add", "path": "@meh/changelog/...", ...})`
3. ‚úÖ Update related facts if needed: `mcp_meh_meh_write({"action": "extend", "fact_id": "...", ...})`

**If you don't document, future AI sessions won't know what you did!**

### Example Workflow

```
1. User: "How does search work?"
2. AI: mcp_meh_meh_facts({"action": "search", "query": "search implementation"})
3. AI: [reads results, answers with context]
4. AI: mcp_meh_meh_write({"action": "add", "path": "@docs/search-explained", "content": "Explanation for future sessions"})
```

**Example: Bug Fix Workflow**
```
1. User: "Fix the API key length bug"
2. AI: [fixes code]
3. AI: mcp_meh_meh_write({
     "action": "add",
     "path": "@meh/bugs/api-key-length-fixed",
     "content": "# API Key Length Bug\n\n## Problem\n...\n## Solution\n...\n## Status\nFIXED 2026-02-01"
   })
4. AI: mcp_meh_meh_write({
     "action": "add", 
     "path": "@meh/changelog/api-key-refactor-2026-02-01",
     "content": "# Refactoring...\n..."
   })
```

### Context Switching (per AI session)

Each AI session can have its own KB context:

```
mcp_meh_meh_context({"action": "switch_context", "context": "local"})  # Use local SQLite
mcp_meh_meh_context({"action": "switch_context", "context": "http://server:3000/kb-slug"})  # Use remote
mcp_meh_meh_context({"action": "show"})  # Show current session context
```

**Note:** Context switching is PER-SESSION and doesn't affect other AI chats or CLI.

## üìÅ Project Structure

<!-- Fill in for your project -->

- `src/` - source code
- `docs/` - documentation
- `.meh/` - knowledge base (SQLite)
